<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ArmorWorkout - Timer d'Entraînement Avancé</title>
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <!-- Chart.js (déjà chargé dans le JS via CDN, mais peut être gardé ici si préféré) -->
    <!-- <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script> -->
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700;900&display=swap" rel="stylesheet">
    <!-- Lien vers le fichier CSS externe -->
    <link rel="stylesheet" href="style.css">
    <!-- Google Identity Services (GIS) - chargé à la fin du body via script tag -->
</head>
<body class="logged-out dark-theme state-idle"> <!-- Classe d'état initiale -->

<header>
    <div class="header-content">
        <h1><i class="fas fa-shield-halved"></i> ArmorWorkout</h1>
        <nav>
            <ul>
                <li><button id="nav-push" data-workout="Push" disabled>Push</button></li>
                <li><button id="nav-pull" data-workout="Pull" disabled>Pull</button></li>
                <li><button id="nav-legs" data-workout="Legs" disabled>Legs</button></li>
                <li><button id="nav-history"><i class="fas fa-history"></i> Historique</button></li>
            </ul>
        </nav>
        <div class="header-actions">
            <div class="auth-controls">
                <button id="signin-button"><i class="fab fa-google"></i> Connecter Drive</button>
                <button id="signout-button"><i class="fas fa-sign-out-alt"></i> Déconnecter</button>
            </div>
            <span id="drive-status"></span>
            <div class="theme-toggle">
                <button id="theme-toggle-btn" aria-label="Basculer le thème"><i class="fas fa-sun"></i></button>
            </div>
        </div>
    </div>
</header>

<div class="container">
    <main>
        <!-- Section Entraînement -->
        <div class="workout-section" id="workout-section">
            <div class="timer-display" id="timer-display-clickable">
                <div class="timer-circle-container">
                    <div id="total-progress-circle"></div>
                    <div class="timer-circle" id="timer-circle">
                        <span class="time-left" id="time-left">00:00</span>
                    </div>
                </div>
                <div class="timer-state" id="timer-state"></div>
            </div>
            <div class="workout-info" id="workout-info">
                <div id="current-exercise-name-display">ArmorWorkout</div> <!-- Titre initial -->
                <div id="current-exercise-container">
                    <div class="idle-message"><i class="fas fa-info-circle"></i> Connectez-vous pour commencer.</div>
                </div>
            </div>
            <div class="controls">
                <button id="start-pause-btn" disabled><i class="fas fa-play"></i> Démarrer</button>
                <button id="skip-btn" disabled><i class="fas fa-forward-step"></i> Suivant</button>
                <button id="finish-btn" disabled><i class="fas fa-flag-checkered"></i> Finir</button>
                <button id="reset-btn" disabled><i class="fas fa-redo"></i> Reset</button>
            </div>
            <div class="progress-tracker" id="progress-tracker">
                <span id="progress-text-area">Sélectionnez un entraînement</span>
                <span id="drive-connection-status-main" style="display: none;">
                    <i class="fab fa-google-drive"></i>
                    <span id="drive-connection-text">Connecté</span>
                </span>
            </div>
        </div>

        <!-- Section Historique -->
        <div class="history-section section-hidden" id="history-section">
            <h2><i class="fas fa-chart-line"></i> Historique & Statistiques</h2>
            <div class="history-controls">
                <div class="history-filters">
                    <button data-period="week" class="active"><i class="fas fa-calendar-week"></i> Semaine</button>
                    <button data-period="month"><i class="fas fa-calendar-alt"></i> Mois</button>
                    <button data-period="year"><i class="fas fa-calendar-check"></i> Année</button>
                    <button data-period="all"><i class="fas fa-infinity"></i> Tout</button>
                </div>
                <div class="history-actions" style="display: none;">
                    <i class="fab fa-google-drive"></i>
                    <span id="history-drive-status">Synchro Drive</span>
                </div>
            </div>
            <div class="chart-container">
                <!-- Chart.js est chargé via CDN dans le JS -->
                <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
                <canvas id="history-chart-canvas"></canvas>
                <p id="chart-placeholder" style="display: none;"></p>
            </div>
            <div class="stats-display" id="stats-display">
                <h3>Statistiques</h3>
                <div class="content-wrapper">
                     <p>Connectez-vous.</p>
                </div>
                <p class="motivational-message"></p>
            </div>
            <ul class="history-list" id="history-list">
                <li class="no-history">Connectez-vous.</li>
            </ul>
        </div>
    </main>
</div>

<footer>
    <p>© 2024 ArmorWorkout. Sauvegarde automatique sur <i class="fab fa-google-drive"></i> Google Drive.</p>
    <p><a href="https://github.com/ironworkout/armorworkout" target="_blank" rel="noopener noreferrer"><i class="fab fa-github"></i> Voir sur GitHub</a></p>
</footer>

<!-- Zone de Message Flottante -->
<div id="message-area" class="message-area"></div>

<!-- Modal Résumé Post-Workout -->
<div id="post-workout-summary" class="post-workout-summary">
    <div class="post-workout-summary-content">
        <h2 id="summary-title">Résumé de la Séance</h2>
        <ul id="summary-items-list" class="summary-items-list"></ul>
        <div class="summary-controls">
            <button id="close-summary-btn"><i class="fas fa-times"></i> Fermer</button>
            <button id="discard-summary-btn"><i class="fas fa-trash-alt"></i> Rejeter Changements</button>
            <button id="confirm-summary-btn"><i class="fas fa-check"></i> Valider & Fermer</button>
        </div>
    </div>
</div>

<!-- Lien vers le fichier JavaScript externe -->
<script src="script.js"></script>

<!-- GIS script DOIT RESTER ICI et être chargé APRES votre script.js si gisLoadedCallback est dedans -->
<!-- Ou il doit être garanti que gisLoadedCallback est global AVANT que ce script ne s'exécute -->
<script async defer src="https://accounts.google.com/gsi/client" onload="gisLoadedCallback()"></script>

</body>
</html>
