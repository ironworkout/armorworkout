/* --- Variables Globales & Thèmes --- */
:root {
    /* Thème Sombre (Base) */
    --bg-color-dark: #0D1117; --secondary-bg-color-dark: #161B22; --primary-text-color-dark: #c9d1d9; --secondary-text-color-dark: #8b949e; --border-color-dark: #30363d; --accent-border-color-dark: #58a6ff33; --input-bg-dark: #0d1117;
    /* Couleurs Néon (Thème Sombre) */
    --neon-blue: #58a6ff; --neon-pink: #f778ba; --neon-red: #ff7b72; --neon-yellow: #facc15; --neon-green: #3fb950; --neon-purple: #bc8cff;
    /* Glows (Thème Sombre) */
    --glow-blue: 0 0 12px rgba(88, 166, 255, 0.6); --glow-pink: 0 0 12px rgba(247, 120, 186, 0.6); --glow-red: 0 0 10px rgba(255, 123, 114, 0.6); --glow-yellow: 0 0 10px rgba(250, 204, 21, 0.5); --glow-green: 0 0 10px rgba(63, 185, 80, 0.6); --glow-purple: 0 0 12px rgba(188, 140, 255, 0.6);
    /* Couleurs spécifiques aux états/types */
    --color-exercise: var(--neon-pink); --glow-exercise: var(--glow-pink); --color-exercise-rgb: 247, 120, 186; --icon-exercise: "\f44b"; /* Font Awesome dumbbell */
    --color-break: var(--neon-yellow); --glow-break: var(--glow-yellow); --color-break-rgb: 250, 204, 21; --icon-break: "\f252"; /* Font Awesome hourglass half */
    --color-prepare: var(--neon-yellow); --glow-prepare: var(--glow-yellow); --color-prepare-rgb: 250, 204, 21; --icon-prepare: "\f110"; /* Font Awesome spinner */
    --color-finished: var(--neon-green); --glow-finished: var(--glow-green); --color-finished-rgb: 63, 185, 80; --icon-finished: "\f058"; /* Font Awesome check circle */
    --color-paused: var(--neon-purple); --glow-paused: var(--glow-purple); --color-paused-rgb: 188, 140, 255; --icon-paused: "\f28b"; /* Font Awesome pause circle */
    --color-idle: var(--secondary-text-color-dark); --glow-idle: none; --color-idle-rgb: 139, 148, 158; --icon-idle: "\f04b"; /* Font Awesome play circle */
    /* --- Autres Variables --- */
    --font-family: 'Inter', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; --border-radius-lg: 12px; --border-radius-md: 8px; --border-radius-sm: 6px; --transition-speed: 0.25s;
    /* Initialisation Thème Sombre par Défaut */
    --bg-color: var(--bg-color-dark); --secondary-bg-color: var(--secondary-bg-color-dark); --primary-text-color: var(--primary-text-color-dark); --secondary-text-color: var(--secondary-text-color-dark); --border-color: var(--border-color-dark); --accent-border-color: var(--accent-border-color-dark); --input-bg: var(--input-bg-dark);
    /* Variables pour le timer */
    --current-step-color: var(--color-idle); --current-step-glow: var(--glow-idle);
    /* Total progress est une variable pour JS */
    --total-progress-gradient: var(--total-progress-bg, #2a2f36);
    --total-progress-bg: #2a2f36;
    /* Boutons Contrôle Timer */
    --button-reset-color: var(--neon-red); --button-reset-glow: var(--glow-red); --button-next-color: var(--neon-purple); --button-next-glow: var(--glow-purple); --button-end-color: var(--secondary-text-color-dark); --button-end-glow: none; --button-start-color: var(--neon-blue); --button-start-glow: var(--glow-blue); --button-pause-color: var(--color-paused); --button-pause-glow: var(--glow-paused); --button-resume-color: var(--color-paused); --button-resume-glow: var(--glow-paused); --button-done-color: var(--color-exercise); --button-done-glow: var(--glow-exercise);
    /* Boutons Connexion */
    --button-connect-color: var(--neon-green); --button-connect-glow: var(--glow-green); --button-disconnect-color: var(--neon-red); --button-disconnect-glow: var(--glow-red); --link-color: var(--neon-blue);
    /* Variables RGBA */
    --neon-blue-rgb: 88, 166, 255; --neon-red-rgb: 255, 123, 114; --neon-green-rgb: 63, 185, 80; --neon-purple-rgb: 188, 140, 255; --secondary-text-color-dark-rgb: 139, 148, 158; --bg-color-dark-rgb: 13, 17, 23; --secondary-bg-color-dark-rgb: 22, 27, 34; --primary-text-color-dark-rgb: 201, 209, 217; --color-exercise-rgb: 247, 120, 186; --color-break-rgb: 250, 204, 21; --color-prepare-rgb: 250, 204, 21; --color-finished-rgb: 63, 185, 80; --color-paused-rgb: 188, 140, 255; --color-idle-rgb: 139, 148, 158;
}

body.light-theme {
    /* Thème Clair */
    --bg-color: #ffffff; --secondary-bg-color: #f6f8fa; --primary-text-color: #24292f; --secondary-text-color: #57606a; --border-color: #d0d7de; --accent-border-color: #0969da33; --input-bg: #f6f8fa;
    /* Couleurs Néon adaptées */
    --neon-blue: #0969da; --neon-pink: #bf3989; --neon-red: #d73a49; --neon-yellow: #dbab09; --neon-green: #2da44e; --neon-purple: #8250df;
    /* Glows (Subtils ou désactivés en clair) */
    --glow-blue: 0 0 8px rgba(9, 105, 218, 0.3); --glow-pink: 0 0 8px rgba(191, 57, 137, 0.3); --glow-red: 0 0 8px rgba(215, 58, 73, 0.3); --glow-yellow: 0 0 8px rgba(219, 171, 9, 0.3); --glow-green: 0 0 8px rgba(45, 164, 78, 0.3); --glow-purple: 0 0 8px rgba(130, 80, 223, 0.3);
    --total-progress-bg: #e1e4e8; --button-end-color: #57606a; --link-color: #0969da;
    /* Adapter les variables RGBA */
    --bg-color-dark-rgb: 255, 255, 255; --secondary-bg-color-dark-rgb: 246, 248, 250; --primary-text-color-dark-rgb: 36, 41, 47; --secondary-text-color-dark-rgb: 87, 96, 106; --color-exercise-rgb: 191, 57, 137; --color-break-rgb: 219, 171, 9; --color-prepare-rgb: 219, 171, 9; --color-finished-rgb: 45, 164, 78; --color-paused-rgb: 130, 80, 223; --color-idle-rgb: 87, 96, 106;
}

/* --- Styles de Base & Réinitialisation --- */
* { box-sizing: border-box; margin: 0; padding: 0; }
html { scroll-behavior: smooth; font-size: 16px; }
body {
    font-family: var(--font-family); background-color: var(--bg-color); color: var(--primary-text-color);
    line-height: 1.6; transition: background-color var(--transition-speed) ease, color var(--transition-speed) ease;
    display: flex; flex-direction: column; min-height: 100vh;
    -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale;
    overflow-x: hidden;
}
.container { max-width: 1100px; margin: 0 auto; padding: 30px 25px; width: 100%; flex-grow: 1; display: flex; flex-direction: column; }

/* --- En-tête --- */
header {
    padding: 15px 0; border-bottom: 1px solid var(--border-color);
    transition: border-color var(--transition-speed) ease, background-color var(--transition-speed) ease;
    position: sticky; top: 0; z-index: 1000;
    background-color: rgba(var(--bg-color-dark-rgb), 0.8);
    backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px);
}
.header-content { display: flex; justify-content: space-between; align-items: center; max-width: 1100px; margin: 0 auto; padding: 0 25px; flex-wrap: wrap; gap: 15px 20px; }
header h1 { font-size: 1.5em; color: var(--primary-text-color); margin: 0; font-weight: 700; display: flex; align-items: center; gap: 10px; }
header h1 i { color: var(--neon-blue); animation: pulse 2s infinite ease-in-out; }
@keyframes pulse { 0%, 100% { transform: scale(1); opacity: 0.8; } 50% { transform: scale(1.1); opacity: 1; } }

/* --- Navigation Header --- */
nav ul { list-style: none; display: flex; gap: 25px; flex-wrap: wrap; justify-content: center; align-items: center; }
nav button {
    background: none; border: none; color: var(--secondary-text-color); font-size: 1em; font-weight: 500; padding: 5px 0;
    cursor: pointer; transition: color var(--transition-speed) ease, box-shadow var(--transition-speed) ease, border-color var(--transition-speed) ease;
    position: relative; border-bottom: 2px solid transparent;
}
nav button:disabled { color: rgba(var(--secondary-text-color-dark-rgb), 0.5); cursor: not-allowed; border-bottom-color: transparent !important; box-shadow: none !important; opacity: 0.6; }
nav button:not(:disabled):hover { color: var(--primary-text-color); }
nav button.active { color: var(--neon-blue); font-weight: 700; border-bottom-color: var(--neon-blue); box-shadow: 0 5px 15px -5px rgba(var(--neon-blue-rgb), 0.4); }
#nav-history { color: var(--secondary-text-color); border-bottom-color: transparent; }
#nav-history:hover:not(:disabled) { color: var(--neon-pink); }
#nav-history.active { color: var(--neon-pink); border-bottom-color: var(--neon-pink); box-shadow: 0 5px 15px -5px rgba(var(--neon-pink-rgb), 0.4); }
#nav-history i { margin-right: 5px; }

/* --- Actions Header --- */
.header-actions { display: flex; gap: 20px; align-items: center; flex-wrap: wrap; }
.auth-controls { display: flex; gap: 10px; align-items: center; }
.auth-controls button {
    background: none; border: 1px solid var(--accent-border-color); color: var(--secondary-text-color); padding: 6px 14px;
    border-radius: var(--border-radius-md); font-size: 0.85em; font-weight: 500; cursor: pointer;
    transition: all var(--transition-speed) ease; display: inline-flex; align-items: center; gap: 6px;
}
.auth-controls button:disabled { opacity: 0.5; cursor: not-allowed; pointer-events: none; }
.auth-controls button:not(:disabled):hover { border-color: var(--primary-text-color); color: var(--primary-text-color); }
#signin-button { border-color: var(--button-connect-color); color: var(--button-connect-color); }
#signin-button:not(:disabled):hover { background-color: rgba(var(--neon-green-rgb), 0.1); box-shadow: var(--glow-green); border-color: var(--neon-green); }
#signout-button { border-color: var(--button-disconnect-color); color: var(--button-disconnect-color); }
#signout-button:not(:disabled):hover { background-color: rgba(var(--neon-red-rgb), 0.1); box-shadow: var(--glow-red); border-color: var(--neon-red); }

#drive-status {
    font-size: 0.8em; color: var(--secondary-text-color); margin-left: 5px; transition: opacity 0.3s, color 0.3s, border-color 0.3s;
    min-width: fit-content; text-align: right; font-style: normal; padding: 4px 8px; background-color: rgba(var(--secondary-bg-color-dark-rgb), 0.5);
    border-radius: var(--border-radius-sm); border: 1px solid var(--border-color); display: none; /* Initialement caché */
}
#drive-status.loading { color: var(--neon-yellow); border-color: var(--neon-yellow); }
#drive-status.error { color: var(--neon-red); border-color: var(--neon-red); }
#drive-status.success { color: var(--neon-green); border-color: var(--neon-green); }

.theme-toggle button { background: none; border: none; color: var(--secondary-text-color); font-size: 1.2em; padding: 5px; cursor: pointer; transition: color var(--transition-speed) ease; }
.theme-toggle button:hover { color: var(--neon-yellow); }

/* Logique affichage connexion/déconnexion */
body.logged-out #signin-button { display: inline-flex; }
body.logged-out #signout-button { display: none; }
body.logged-out #drive-status { display: none; }
body.logged-out .history-actions { display: none !important; }
body.logged-out #drive-connection-status-main { display: none; }

body.logged-in #signin-button { display: none; }
body.logged-in #signout-button { display: inline-flex; }
body.logged-in #drive-status { display: inline-block; }
body.logged-in .history-actions { display: flex !important; }
body.logged-in #drive-connection-status-main { display: inline-flex; }

/* --- Contenu Principal --- */
main { flex-grow: 1; display: flex; flex-direction: column; align-items: center; padding-top: 50px; position: relative; }
.workout-section { background-color: transparent; padding: 0; border: none; box-shadow: none; width: 100%; max-width: 600px; text-align: center; transition: transform 0.5s ease, opacity 0.5s ease, max-height 0.5s ease; margin-bottom: 40px; }
.history-section { background-color: var(--secondary-bg-color); padding: 35px; border-radius: var(--border-radius-lg); box-shadow: none; border: 1px solid var(--border-color); width: 100%; max-width: 850px; text-align: left; margin-bottom: 40px; transition: transform 0.5s ease, opacity 0.5s ease, max-height 0.5s ease; }
.section-hidden { transform: scale(0.9) translateY(30px); opacity: 0; pointer-events: none; max-height: 0; padding-top: 0 !important; padding-bottom: 0 !important; margin-bottom: 0 !important; border: none !important; overflow: hidden; }

/* --- Affichage Timer --- */
.timer-display { margin-bottom: 50px; position: relative; display: flex; justify-content: center; align-items: center; width: 320px; height: 320px; margin-left: auto; margin-right: auto; cursor: pointer; user-select: none; -webkit-tap-highlight-color: transparent; }
.timer-circle-container { position: relative; width: 100%; height: 100%; display: flex; justify-content: center; align-items: center; pointer-events: none; }
#total-progress-circle, .timer-circle { position: absolute; top: 0; left: 0; width: 100%; height: 100%; border-radius: 50%; display: flex; justify-content: center; align-items: center; border: 12px solid transparent; background-clip: padding-box; background-origin: border-box; box-sizing: border-box; }
#total-progress-circle {
    border-color: var(--total-progress-bg);
    background: var(--total-progress-gradient, var(--total-progress-bg));
    box-shadow: 0 0 25px rgba(var(--neon-blue-rgb), 0.3), 0 0 35px rgba(var(--neon-pink-rgb), 0.2), inset 0 0 20px rgba(var(--bg-color-dark-rgb), 0.5);
    z-index: 1; transition: background 0.3s linear;
}
.timer-circle {
    width: calc(100% - 48px); height: calc(100% - 48px); top: 24px; left: 24px;
    border-color: var(--border-color);
    background-image: conic-gradient(var(--current-step-color, var(--color-idle)) 0%, transparent 0%);
    box-shadow: var(--current-step-glow, var(--glow-idle)), inset 0 0 15px rgba(var(--bg-color-dark-rgb), 0.6);
    z-index: 3; transition: background-image 0.15s linear, box-shadow var(--transition-speed) ease, border-color var(--transition-speed) ease;
    background-size: 100% 100%; background-repeat: no-repeat; background-position: center center;
}
.timer-circle::before { content: ''; position: absolute; width: calc(100% - 24px); height: calc(100% - 24px); background-color: var(--bg-color); border-radius: 50%; z-index: 4; transition: background-color var(--transition-speed) ease; }
.time-left { font-size: 5.5em; font-weight: 900; color: var(--primary-text-color); z-index: 5; transition: color var(--transition-speed) ease; font-variant-numeric: tabular-nums; position: relative; text-shadow: 0 0 10px rgba(var(--primary-text-color-dark-rgb), 0.3); }

.timer-state {
    position: absolute; bottom: 15%; left: 50%; transform: translateX(-50%); font-size: 0.9em; letter-spacing: 0.08em;
    color: var(--current-step-color, var(--color-idle));
    font-weight: 500; text-transform: uppercase; opacity: 0; transition: opacity 0.3s ease, color var(--transition-speed) ease;
    background-color: transparent; padding: 0; box-shadow: none; z-index: 6;
    text-shadow: 0 0 8px rgba(var(--bg-color-dark-rgb), 0.7);
}
.timer-state.visible { opacity: 0.9; }
.timer-state.preparing { animation: countdown-pulse 1s infinite; font-size: 1.1em; }
@keyframes countdown-pulse { 0%, 100% { transform: translateX(-50%) scale(1); opacity: 1; } 50% { transform: translateX(-50%) scale(1.05); opacity: 0.85; } }

/* --- Infos Exercice --- */
.workout-info { margin-bottom: 40px; min-height: 100px; position: relative; text-align: center; display: flex; flex-direction: column; align-items: center; gap: 10px; }
#current-exercise-name-display { display: block; font-size: 1.4em; font-weight: 700; color: var(--primary-text-color); margin-bottom: 8px; padding: 0 10px; min-height: 1.5em; transition: color 0.3s ease; }
body.state-exercise #current-exercise-name-display { color: var(--color-exercise); }
body.state-break #current-exercise-name-display { color: var(--color-break); }
body.state-paused #current-exercise-name-display { color: var(--color-paused); }
body.state-preparing #current-exercise-name-display { color: var(--color-prepare); }
body.state-finished #current-exercise-name-display { color: var(--color-finished); }

#current-exercise-container { display: flex; flex-direction: column; align-items: center; gap: 8px; font-size: 1.1em; color: var(--secondary-text-color); min-height: 3em; width: 100%; }
#current-exercise-container .exercise-details,
#current-exercise-container .break-info,
#current-exercise-container .idle-message {
    display: flex; flex-wrap: wrap; justify-content: center; align-items: center; gap: 10px 20px;
    background-color: rgba(var(--secondary-bg-color-dark-rgb), 0.3); padding: 10px 18px; border-radius: var(--border-radius-md);
    border: 1px solid var(--border-color); width: fit-content; max-width: 90%;
    transition: background-color 0.3s ease, border-color 0.3s ease;
}
#current-exercise-container .exercise-details span,
#current-exercise-container .break-info span { display: flex; align-items: center; gap: 6px; font-weight: 500; }
#current-exercise-container .exercise-details span i.fa-dumbbell { color: var(--color-exercise); } /* Icone exo */
#current-exercise-container .exercise-details span i.fa-weight-hanging { color: var(--neon-blue); opacity: 0.9; } /* Icone poids */
#current-exercise-container .break-info i { color: var(--color-break); }
#current-exercise-container .exercise-details .details-text { font-size: 0.9em; opacity: 0.8; margin-top: 5px; flex-basis: 100%; text-align: center;} /* Pour détails en dessous */
#current-exercise-container .idle-message { border-style: dashed; opacity: 0.7; }

/* Style pour l'affichage des performances précédentes */
#previous-performance-display {
    font-style: italic; opacity: 0.8;
    background-color: rgba(var(--secondary-bg-color-dark-rgb), 0.2);
    padding: 5px 10px;
    border-radius: var(--border-radius-sm);
    border: 1px dashed var(--border-color);
    width: fit-content;
    max-width: 90%;
    margin-left: auto; margin-right: auto; /* Centrer */
}

/* --- Progress Tracker --- */
.progress-tracker { font-size: 0.9em; color: var(--secondary-text-color); margin-top: 30px; opacity: 0.8; font-weight: 500; display: flex; flex-wrap: wrap; align-items: center; justify-content: center; gap: 5px 15px; min-height: 1.2em; }
#drive-connection-status-main { align-items: center; gap: 6px; }
#drive-connection-status-main i.fa-google-drive { color: var(--neon-green); font-size: 1.1em; }
#drive-connection-status-main i.fa-google-drive.fa-spin { animation: fa-spin 2s linear infinite; }
@keyframes fa-spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
#progress-text-area { font-weight: 500; }

/* --- Contrôles Timer --- */
.controls { display: flex; justify-content: center; gap: 15px; margin-top: 40px; flex-wrap: wrap; }
.controls button {
    background: transparent; border: 2px solid var(--accent-border-color); color: var(--primary-text-color); min-width: 110px; padding: 10px 20px;
    border-radius: var(--border-radius-lg); font-size: 1.05em; font-weight: 500; cursor: pointer; transition: all var(--transition-speed) ease;
    display: inline-flex; align-items: center; justify-content: center; gap: 8px;
}
.controls button i { font-size: 0.9em; transition: transform 0.2s ease; }
.controls button:disabled { border-color: var(--border-color) !important; color: var(--secondary-text-color) !important; opacity: 0.5; cursor: not-allowed; box-shadow: none !important; transform: none !important; background-color: transparent !important; pointer-events: none; }
.controls button:not(:disabled):hover { transform: translateY(-2px); box-shadow: 0 4px 8px rgba(0,0,0,0.1); }
.controls button:not(:disabled):hover i { transform: scale(1.1); }
.controls button:not(:disabled):active { transform: scale(0.97); }

/* Styles spécifiques aux boutons basés sur la classe JS */
#start-pause-btn.start-btn { border-color: var(--button-start-color); color: var(--button-start-color); }
#start-pause-btn.start-btn:not(:disabled):hover { box-shadow: var(--glow-blue), 0 4px 8px rgba(0,0,0,0.1); background-color: rgba(var(--neon-blue-rgb), 0.08); }
#start-pause-btn.pause-btn { border-color: var(--button-pause-color); color: var(--button-pause-color); }
#start-pause-btn.pause-btn:not(:disabled):hover { box-shadow: var(--glow-paused), 0 4px 8px rgba(0,0,0,0.1); background-color: rgba(var(--color-paused-rgb), 0.08); }
#start-pause-btn.resume-btn { border-color: var(--button-resume-color); color: var(--button-resume-color); }
#start-pause-btn.resume-btn:not(:disabled):hover { box-shadow: var(--glow-paused), 0 4px 8px rgba(0,0,0,0.1); background-color: rgba(var(--color-paused-rgb), 0.08); }
#start-pause-btn.done-btn { border-color: var(--button-done-color); color: var(--button-done-color); }
#start-pause-btn.done-btn:not(:disabled):hover { box-shadow: var(--glow-exercise), 0 4px 8px rgba(0,0,0,0.1); background-color: rgba(var(--color-exercise-rgb), 0.08); }
#start-pause-btn.finished-btn { border-color: var(--color-finished); color: var(--color-finished); }
#start-pause-btn.finished-btn:not(:disabled):hover { box-shadow: var(--glow-finished), 0 4px 8px rgba(0,0,0,0.1); background-color: rgba(var(--color-finished-rgb), 0.08); }
#start-pause-btn.preparing-btn { border-color: var(--color-prepare); color: var(--color-prepare); opacity: 0.7; cursor: default; } /* Style pour bouton pendant prépa */


#skip-btn { border-color: var(--button-next-color); color: var(--button-next-color); }
#skip-btn:not(:disabled):hover { box-shadow: var(--glow-purple), 0 4px 8px rgba(0,0,0,0.1); background-color: rgba(var(--neon-purple-rgb), 0.08); }
#finish-btn { border-color: var(--button-end-color); color: var(--button-end-color); }
#finish-btn:not(:disabled):hover { background-color: rgba(var(--secondary-text-color-dark-rgb), 0.1); border-color: var(--primary-text-color); color: var(--primary-text-color); box-shadow: 0 4px 8px rgba(0,0,0,0.1); }
#reset-btn { border-color: var(--button-reset-color); color: var(--button-reset-color); }
#reset-btn:not(:disabled):hover { box-shadow: var(--glow-red), 0 4px 8px rgba(0,0,0,0.1); background-color: rgba(var(--neon-red-rgb), 0.08); }

/* --- Section Historique --- */
.history-section h2 { color: var(--primary-text-color); margin-bottom: 25px; text-align: center; }
.history-controls { padding-bottom: 20px; margin-bottom: 25px; border-bottom: 1px solid var(--border-color); display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 15px; }
.history-filters { display: flex; gap: 10px; flex-wrap: wrap; }
.history-filters button { background-color: transparent; border: 1px solid var(--accent-border-color); color: var(--secondary-text-color); opacity: 1; font-size: 0.85em; padding: 6px 12px; border-radius: var(--border-radius-md); cursor: pointer; transition: all var(--transition-speed) ease; display: inline-flex; align-items: center; gap: 5px; }
.history-filters button:not(:disabled):hover { border-color: var(--primary-text-color); color: var(--primary-text-color); background-color: rgba(var(--secondary-text-color-dark-rgb), 0.1); }
.history-filters button.active { border-color: var(--neon-blue); color: var(--neon-blue); background-color: rgba(var(--neon-blue-rgb), 0.1); font-weight: 500; box-shadow: var(--glow-blue); }
.history-actions { display: flex; gap: 15px; align-items: center; color: var(--secondary-text-color); }
.history-actions i.fab.fa-google-drive { color: var(--neon-green); font-size: 1.1em; }
#history-drive-status { font-size: 0.8em; padding: 3px 6px; background-color: rgba(var(--secondary-bg-color-dark-rgb), 0.5); border-radius: var(--border-radius-sm); border: 1px solid var(--border-color); }
.history-export-btn {
    background-color: transparent; border: 1px solid var(--accent-border-color); color: var(--secondary-text-color);
    font-size: 0.85em; padding: 5px 10px; border-radius: var(--border-radius-md); cursor: pointer;
    transition: all var(--transition-speed) ease; display: inline-flex; align-items: center; gap: 5px; margin-left: 10px;
}
.history-export-btn:hover:not(:disabled) { border-color: var(--neon-purple); color: var(--neon-purple); background-color: rgba(var(--neon-purple-rgb), 0.1); }
.chart-container { height: 350px; margin-bottom: 30px; background-color: transparent; border: 1px solid var(--border-color); border-radius: var(--border-radius-md); padding: 15px; box-shadow: none; position: relative; }
#chart-placeholder { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); color: var(--secondary-text-color); font-style: italic; text-align: center; padding: 0 10px;}
.stats-display { margin-bottom: 30px; padding: 20px; background-color: transparent; border: 1px solid var(--border-color); border-radius: var(--border-radius-md); box-shadow: none; }
.stats-display h3 { color: var(--primary-text-color); margin-bottom: 15px; font-size: 1.15em;}
.stats-display .content-wrapper p { margin-bottom: 8px; display: flex; align-items: center; gap: 8px;} /* Cibler le contenu généré */
.stats-display .content-wrapper p i { width: 16px; text-align: center; color: var(--neon-blue); opacity: 0.8;}
.stats-display .content-wrapper p strong { color: var(--primary-text-color); font-weight: 500; }
.stats-display .content-wrapper p:last-child { margin-bottom: 0; }
.stats-display .motivational-message { font-style: italic; font-weight: 500; margin-top: 15px !important; background: linear-gradient(90deg, var(--neon-green), var(--neon-blue)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; text-fill-color: transparent; }
.history-list { list-style: none; border: 1px solid var(--border-color); border-radius: var(--border-radius-md); background-color: transparent; box-shadow: none; max-height: 400px; overflow-y: auto; }
.history-list li { display: flex; justify-content: space-between; align-items: center; padding: 12px 15px; border-bottom: 1px solid var(--border-color); transition: background-color 0.2s ease; gap: 15px; flex-wrap: wrap; }
.history-list li:last-child { border-bottom: none; }
.history-list li:nth-child(even) { background-color: rgba(var(--secondary-bg-color-dark-rgb), 0.3); }
.history-list li:hover { background-color: rgba(var(--neon-blue-rgb), 0.08); }
.history-item-date { color: var(--primary-text-color); font-size: 0.9em; flex-shrink: 0; }
.history-item-date small { color: var(--secondary-text-color); font-size: 0.9em;}
.history-item-type { color: var(--neon-pink); background-color: rgba(var(--neon-pink-rgb), 0.1); border-radius: var(--border-radius-sm); padding: 3px 8px; font-size: 0.85em; font-weight: 500; text-align: center; min-width: 50px; flex-shrink: 0; margin: 5px 0; }
.history-item-duration { color: var(--neon-blue); font-weight: 500; font-variant-numeric: tabular-nums; flex-shrink: 0; margin-left: auto; margin: 5px 0; }
.history-list .no-history { color: var(--secondary-text-color); text-align: center; padding: 30px 15px; font-style: italic; border: none; background: none !important; }

/* --- Résumé Post-Workout (MODAL) --- */
.post-workout-summary {
    position: fixed; inset: 0; background-color: rgba(var(--bg-color-dark-rgb), 0.85); backdrop-filter: blur(8px); -webkit-backdrop-filter: blur(8px);
    z-index: 2000; display: flex; align-items: center; justify-content: center; padding: 20px; opacity: 0; visibility: hidden; pointer-events: none;
    transition: opacity 0.3s ease, visibility 0.3s ease;
}
.post-workout-summary.visible { opacity: 1; visibility: visible; pointer-events: auto; }
.post-workout-summary-content {
    background-color: var(--secondary-bg-color); border: 1px solid var(--border-color); border-radius: var(--border-radius-lg); box-shadow: 0 10px 30px rgba(0,0,0,0.3);
    width: 100%; max-width: 680px; max-height: 90vh; display: flex; flex-direction: column; overflow: hidden; transform: scale(0.95); transition: transform 0.3s ease;
}
.post-workout-summary.visible .post-workout-summary-content { transform: scale(1); }
.post-workout-summary h2 { color: var(--primary-text-color); font-size: 1.5em; font-weight: 700; padding: 20px 25px; border-bottom: 1px solid var(--border-color); flex-shrink: 0; text-align: center; background-color: rgba(var(--bg-color-dark-rgb), 0.2); }
.summary-items-list { list-style: none; padding: 10px 25px; overflow-y: auto; flex-grow: 1; background: var(--bg-color); border-bottom: 1px solid var(--border-color); }
.summary-item {
    border-bottom: 1px solid var(--border-color); padding: 18px 0; display: grid;
    grid-template-columns: auto 1fr auto; grid-template-areas: "title title title" "label inputs inputs" "details details details"; /* Ajustement Grid */
    gap: 10px 15px; align-items: center;
}
.summary-item:last-child { border-bottom: none; }
.summary-item h4 { grid-area: title; color: var(--primary-text-color); font-size: 1.15em; margin-bottom: 12px; display: flex; align-items: center; gap: 10px; }
.summary-item h4 i { width: 20px; text-align: center; font-size: 1.1em; }
.summary-item.item-type-exercise h4 i { color: var(--color-exercise); }
.summary-item.item-type-break h4 i { color: var(--color-break); }
.summary-item label {
    grid-area: label; color: var(--secondary-text-color); font-size: 0.9em; font-weight: 500; white-space: nowrap; text-align: left; padding-left: 5px; align-self: center; /* Alignement vertical */
}
.summary-item .input-container { grid-area: inputs; display: flex; align-items: center; gap: 8px; flex-wrap: wrap; /* Permettre wrap */ }
.summary-item input[type="number"], .summary-item input[type="text"], .summary-item textarea {
    background-color: var(--input-bg); border: 1px solid var(--border-color); color: var(--primary-text-color);
    border-radius: var(--border-radius-sm); padding: 8px 12px; font-size: 1em; width: 100%;
    transition: border-color var(--transition-speed) ease, background-color var(--transition-speed) ease, box-shadow var(--transition-speed) ease;
}
.summary-item input[type="number"] { /* Style commun pour reps et poids */
     width: 70px; text-align: center; flex-shrink: 0; -moz-appearance: textfield; }
.summary-item input[type="number"]::-webkit-outer-spin-button,
.summary-item input[type="number"]::-webkit-inner-spin-button { -webkit-appearance: none; margin: 0; }
.summary-item input.weight-input { margin-left: 5px; margin-right: 5px;} /* Espace autour du poids */
.summary-item .input-container span.unit { font-size: 0.9em; color: var(--secondary-text-color); } /* Pour "kg" */

.summary-item input:focus, .summary-item textarea:focus { border-color: var(--neon-blue); background-color: var(--bg-color); outline: none; box-shadow: 0 0 0 3px rgba(var(--neon-blue-rgb), 0.3); }
.summary-item textarea { min-height: 45px; resize: vertical; width: 100%; }
.summary-item .details-container { grid-area: details; margin-top: 5px; }
.summary-item .details-container label { display: block; text-align: left; margin-bottom: 4px; font-size: 0.9em; color: var(--secondary-text-color); padding-left: 0; }
.summary-item p { /* Utilisé pour les pauses */
     grid-column: 2 / -1; color: var(--primary-text-color); font-weight: 500; padding-left: 5px; align-self: center; }

.rep-adjust-btn {
    background-color: var(--secondary-bg-color); border: 1px solid var(--border-color); color: var(--primary-text-color);
    border-radius: 50%; width: 28px; height: 28px; font-size: 1em; line-height: 26px; text-align: center;
    cursor: pointer; transition: all var(--transition-speed) ease; flex-shrink: 0;
}
.rep-adjust-btn:hover { background-color: var(--accent-border-color); border-color: var(--neon-blue); color: var(--neon-blue); }
.rep-adjust-btn:active { transform: scale(0.95); }

.summary-controls {
    padding: 20px 25px; display: flex; justify-content: flex-end; gap: 15px;
    flex-shrink: 0; flex-wrap: wrap; border-top: 1px solid var(--border-color); background-color: rgba(var(--bg-color-dark-rgb), 0.2);
}
.summary-controls button {
    border: none; color: white; min-width: 160px; padding: 10px 22px; border-radius: var(--border-radius-md);
    font-size: 1em; font-weight: 500; cursor: pointer; transition: all var(--transition-speed) ease;
    display: inline-flex; align-items: center; justify-content: center; gap: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.2);
}
.summary-controls button:disabled { opacity: 0.6; cursor: not-allowed; box-shadow: none; background-color: var(--secondary-text-color) !important; }
.summary-controls button:not(:disabled):hover { filter: brightness(1.1); box-shadow: 0 4px 10px rgba(0,0,0,0.25); transform: translateY(-1px); }
.summary-controls button:not(:disabled):active { filter: brightness(0.95); transform: translateY(0); box-shadow: 0 1px 3px rgba(0,0,0,0.2); }

#confirm-summary-btn { background-color: var(--neon-green); }
#discard-summary-btn { background-color: var(--neon-red); }
#close-summary-btn { background-color: var(--secondary-text-color); display: none; }


/* --- Animation Fin Workout --- */
.timer-display.finished-animation .timer-circle {
    animation: finish-circle-glow 1.5s ease-out forwards;
}
@keyframes finish-circle-glow {
    0% { box-shadow: var(--current-step-glow), inset 0 0 15px rgba(var(--bg-color-dark-rgb), 0.6); border-color: var(--border-color); }
    50% { box-shadow: 0 0 35px 15px rgba(var(--color-finished-rgb), 0.7), inset 0 0 15px rgba(var(--bg-color-dark-rgb), 0.4); border-color: var(--color-finished); }
    100% { box-shadow: var(--glow-finished), inset 0 0 15px rgba(var(--bg-color-dark-rgb), 0.6); border-color: var(--color-finished); }
}

/* --- Zone de Messages Flottante --- */
.message-area { position: fixed; bottom: 25px; left: 50%; transform: translateX(-50%); background-color: rgba(var(--secondary-bg-color-dark-rgb), 0.9); color: var(--primary-text-color); border: 1px solid var(--border-color); padding: 12px 25px; border-radius: var(--border-radius-md); z-index: 3000; opacity: 0; transition: opacity 0.5s ease, transform 0.5s ease, bottom 0.5s ease; pointer-events: none; font-size: 0.95em; box-shadow: 0 4px 15px rgba(0,0,0,0.2); backdrop-filter: blur(5px); -webkit-backdrop-filter: blur(5px); max-width: 90%; text-align: center; }
.message-area.visible { opacity: 1; transform: translate(-50%, 0); bottom: 40px; pointer-events: auto; }

/* --- Pied de Page --- */
footer { color: var(--secondary-text-color); opacity: 0.7; border-top: 1px solid var(--border-color); margin-top: 60px; padding: 25px; text-align: center; }
footer a { color: var(--link-color); text-decoration: none; }
footer a:hover { color: var(--primary-text-color); text-decoration: underline; }
footer .fab.fa-google-drive { color: #4CAF50; }

/* --- Styles pour l'ajustement des reps PENDANT l'entraînement --- */
#in-workout-rep-adjust-container {
    background-color: rgba(var(--secondary-bg-color-dark-rgb), 0.3);
    border: 1px solid var(--border-color);
    border-radius: var(--border-radius-md);
    padding: 10px 15px;
    display: flex; /* Changé pour être géré par JS */
    align-items: center;
    justify-content: center;
    gap: 15px;
    flex-wrap: wrap;
    max-width: 90%;
    margin-left: auto; margin-right: auto; /* Centrer */
}
.in-workout-rep-adjust-btn { /* Similaire aux boutons du résumé */
    background-color: var(--secondary-bg-color); border: 1px solid var(--border-color); color: var(--primary-text-color); border-radius: 50%; width: 30px; height: 30px; font-size: 1.1em; line-height: 28px; text-align: center; cursor: pointer; transition: all var(--transition-speed) ease; flex-shrink: 0;
}
.in-workout-rep-adjust-btn:hover { background-color: var(--accent-border-color); border-color: var(--neon-blue); color: var(--neon-blue); }
.in-workout-rep-adjust-btn:active { transform: scale(0.95); } #in-workout-rep-adjust-container span { font-size: 0.9em; color: var(--secondary-text-color); font-weight: 500; } #in-workout-rep-adjust-container strong { color: var(--primary-text-color); font-weight: 700; /* Un peu plus visible */ }

/* --- Styles Responsives --- */
@media (max-width: 768px) {
    header h1 { font-size: 1.3em; }
    nav ul { gap: 15px; }
    .header-actions { gap: 15px; }
    .timer-display { width: 280px; height: 280px; }
    .timer-circle { width: calc(100% - 40px); height: calc(100% - 40px); top: 20px; left: 20px; border-width: 10px; }
    .timer-circle::before { width: calc(100% - 20px); height: calc(100% - 20px); }
    .time-left { font-size: 4.5em; }
    #total-progress-circle { border-width: 10px; }
    .controls { gap: 15px; }
    .controls button { min-width: 100px; padding: 10px 18px; font-size: 1em; }
    .history-controls { flex-direction: column; align-items: stretch; gap: 15px; }
    .history-actions { justify-content: center; }
    .chart-container { height: 320px; padding: 10px; }
    .stats-display { padding: 15px; }
    .history-list li { padding: 10px; gap: 10px; font-size: 0.95em;}
    .post-workout-summary-content { padding: 0; max-width: 95%; max-height: 85vh; }
    .post-workout-summary h2 { padding: 15px 20px; font-size: 1.3em; }
    .summary-items-list { padding: 10px 20px; }
    .summary-item { grid-template-columns: auto 1fr; grid-template-areas: "title title" "label inputs" "details details"; gap: 8px 10px;} /* Ajustement Grid */
    .summary-item label { font-size: 0.85em; }
    .summary-item input[type="number"] { width: 60px !important; padding: 6px 8px !important; }
    .rep-adjust-btn { width: 24px; height: 24px; font-size: 0.9em; line-height: 22px; }
    .summary-item .weight-input { width: 70px !important; padding: 6px 8px !important; }
    .summary-controls { padding: 15px 20px; justify-content: space-around; }
    .summary-controls button { min-width: 130px; padding: 10px 18px; }
}
@media (max-width: 480px) {
    header { padding: 15px 0;}
    header h1 { font-size: 1.2em; }
    nav ul { gap: 10px; justify-content: center;}
    .header-content { justify-content: center; }
    .header-actions { justify-content: center; }
    .auth-controls { flex-wrap: wrap; justify-content: center; gap: 8px;}
    .timer-display { width: 240px; height: 240px; margin-bottom: 40px; }
    .timer-circle { width: calc(100% - 32px); height: calc(100% - 32px); top: 16px; left: 16px; border-width: 8px; }
    .timer-circle::before { width: calc(100% - 16px); height: calc(100% - 16px); }
    .time-left { font-size: 3.8em; }
    #total-progress-circle { border-width: 8px; }
    .workout-info { min-height: 80px; margin-bottom: 30px; }
    #current-exercise-name-display { font-size: 1.2em; }
    #current-exercise-container { font-size: 1em; }
    #current-exercise-container .exercise-details,
    #current-exercise-container .break-info,
    #current-exercise-container .idle-message { padding: 8px 12px; gap: 8px 15px; max-width: 95%;}
    #current-exercise-container .exercise-details span { flex-basis: auto; justify-content: center;} /* Ajustement pour petits écrans */
    #current-exercise-container .exercise-details .details-text { text-align: center; }
    #previous-performance-display { font-size: 0.85em; padding: 4px 8px; }
    .controls { gap: 10px; margin-top: 30px; flex-direction: column; align-items: stretch; }
    .controls button { width: 100%; min-width: 0; padding: 12px; font-size: 1em; }
    .progress-tracker { margin-top: 25px; font-size: 0.85em;}
    .history-section { padding: 20px; }
    .history-controls { padding-bottom: 15px; margin-bottom: 20px;}
    .history-filters button { font-size: 0.8em; padding: 5px 10px; }
    .chart-container { height: 280px; }
    .stats-display { padding: 12px; font-size: 0.9em;}
    .stats-display .content-wrapper p { gap: 6px;}
    .history-list li { font-size: 0.9em; flex-direction: column; align-items: flex-start; gap: 5px; }
    .history-item-duration { margin-left: 0; }
    .history-item-type { align-self: flex-start; }
    .post-workout-summary-content { max-width: 100%; max-height: 90vh; border-radius: var(--border-radius-md); }
    .post-workout-summary h2 { font-size: 1.2em; padding: 12px 15px;}
    .summary-items-list { padding: 8px 15px; }
    .summary-item { grid-template-columns: auto 1fr; grid-template-areas: "title title" "label inputs" "details details"; gap: 5px 10px; padding: 12px 0; }
    .summary-item label { grid-column: 1 / 2; text-align: left; }
    .summary-item .input-container { grid-column: 2 / 3; justify-content: flex-start; flex-wrap: wrap; gap: 5px; /* Ensure wrap */}
    .summary-item input[type="number"] { width: 60px !important; padding: 6px 8px !important; }
    .summary-item .weight-input { width: 65px !important; margin-left: 5px; }
    .summary-item .details-container { grid-column: 1 / -1; }
    .summary-item p { grid-column: 1 / -1; text-align: left; padding-left: 0; }
    .summary-controls { flex-direction: column; gap: 10px; }
    .summary-controls button { width: 100%; }
    /* Ajustement reps en entraînement */
    #in-workout-rep-adjust-container { gap: 10px; padding: 8px 12px;}
    .in-workout-rep-adjust-btn { width: 26px; height: 26px; font-size: 1em; line-height: 24px;}
    #in-workout-rep-adjust-container span { font-size: 0.85em;}
}
